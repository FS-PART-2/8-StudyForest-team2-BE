@baseUrl = http://localhost:3000
@path = /api/users
@register = {{baseUrl}}{{path}}/register
@login = {{baseUrl}}{{path}}/login
@refresh = {{baseUrl}}{{path}}/refresh
@logout = {{baseUrl}}{{path}}/logout
@me = {{baseUrl}}{{path}}/me
### ------------------------------------------------------------
### 1) 회원가입 성공 케이스
###   - username: 3~20자
###   - email: 유효한 형식
###   - password: 소문자+숫자 조합만, 8~30자 (예: abcd1234)
###   - nick: 1~10자
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json

{
  "username": "chijunee",
  "email": "me@example.com",
  "password": "abcd1234",
  "nick": "원치준"
}

### ------------------------------------------------------------
### 2) 이메일/아이디 중복 케이스 (위와 동일 값 재요청 → 409 기대)
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json


{
  "username": "chijunee",
  "email": "me@example.com",
  "password": "abcd1234",
  "nick": "원치준"
}

### ------------------------------------------------------------
### 3) 잘못된 이메일 형식 (400 기대)
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json

{
  "username": "chijunee2",
  "email": "not-an-email",
  "password": "abcd1234",
  "nick": "치준"
}

### ------------------------------------------------------------
### 4) 비밀번호 정책 위반 - 8자 미만 (400 기대)
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json

{
  "username": "shortpass",
  "email": "short@example.com",
  "password": "abc1234",    
  "nick": "치준"
}

### ------------------------------------------------------------
### 5) 비밀번호 정책 위반 - 대문자 포함 (400 기대)
###   - 대문자/특수문자 금지
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json


{
  "username": "badpwd1",
  "email": "badpwd1@example.com",
  "password": "Abcd1234",    
  "nick": "정책위반"
}
### ------------------------------------------------------------
### 6) 비밀번호 정책 위반 - 특수문자 포함 (400 기대)
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json

{
  "username": "badpwd2",
  "email": "badpwd2@example.com",
  "password": "abcd1234!",  
  "nick": "위반2"
}

### ------------------------------------------------------------
### 7) username 포맷 위반 
###    * 만약 username 검증을 express-validator에 추가했다면 유효성 실패로 떨어짐
###    - 공백/특수문자 포함 혹은 길이 < 3 또는 > 20
### ------------------------------------------------------------
POST {{register}}
Content-Type: application/json

{
  "username": "bad name!",  
  "email": "baduser@example.com",
  "password": "abcd1234",
  "nick": "배드유저"
}

### ------------------------------------------------------------
### 1) 로그인 성공 (200 기대)
###    - 위 회원가입 테스트에서 생성한 계정 사용
###    - 응답: accessToken (JSON), refreshToken (httpOnly 쿠키)
### ------------------------------------------------------------
POST {{login}}
Content-Type: application/json

{
  "email": "me@example.com",
  "password": "abcd1234"
}


### ------------------------------------------------------------
### 2) 잘못된 비밀번호 (401 기대)
### ------------------------------------------------------------
POST {{login}}
Content-Type: application/json

{
  "email": "me@example.com",
  "password": "wrongpass1" 
}


### ------------------------------------------------------------
### 3) 존재하지 않는 이메일 (401 기대)
### ------------------------------------------------------------
POST {{login}}
Content-Type: application/json


{
  "email": "nouser@example.com",
  "password": "abcd1234"
}

### ------------------------------------------------------------
### 4) 유효성 실패 - 이메일 형식 아님 (400 기대)
### ------------------------------------------------------------
POST {{login}}
Content-Type: application/json

{
  "email": "not-an-email",
  "password": "abcd1234"
}

### ------------------------------------------------------------
### 5) 유효성 실패 - 비밀번호 8자 미만 (400 기대)
### ------------------------------------------------------------
POST {{login}}
Content-Type: application/json

{
  "email": "me@example.com",
  "password": "Abc123"
}

### ------------------------------------------------------------
### 6) 액세스 토큰 재발급 (200 기대)
###    - 1)에서 받은 httpOnly refreshToken 쿠키를 사용
###    - 응답: 새 accessToken (JSON), 새 refreshToken (쿠키 회전)
### ------------------------------------------------------------
POST {{refresh}}
Content-Type: application/json

{}

### ------------------------------------------------------------
### 7) 로그아웃 (200 기대)
###    - 현재 보유한 refreshToken 쿠키 무효화 + 쿠키 삭제
### ------------------------------------------------------------
POST {{logout}}
Content-Type: application/json

{}


### 1) 내 프로필 조회 (200 기대)
GET {{me}}
Authorization: Bearer {{accessToken}}

### 2) 닉네임 변경 (200 기대)
PATCH {{me}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "nick": "치준짱"
}

### 3) 이메일 변경 (200 기대)
PATCH {{me}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "email": "me2@example.com"
}

### 4) 사용자명 변경 (200 기대)
PATCH {{me}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "username": "chijunee_new"
}

### 5) 비밀번호 변경 (200 기대)
PATCH {{me}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "currentPassword": "abcd1234",
  "newPassword": "qwer5678"
}

### 6) 잘못된 현재 비밀번호로 비번 변경 시도 (400 기대)
PATCH {{me}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "currentPassword": "wrongpass1",
  "newPassword": "another12"
}